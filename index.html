<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”»åƒ9åˆ†å‰²ã‚¢ãƒ—ãƒª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
            max-width: 600px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 0.9em;
        }

        .drop-zone {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 60px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9ff;
        }

        .drop-zone:hover {
            border-color: #764ba2;
            background: #f0f2ff;
            transform: scale(1.02);
        }

        .drop-zone.dragover {
            border-color: #764ba2;
            background: #e8ebff;
            transform: scale(1.05);
        }

        .drop-zone-icon {
            font-size: 4em;
            margin-bottom: 20px;
        }

        .drop-zone-text {
            font-size: 1.2em;
            color: #667eea;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .drop-zone-subtext {
            color: #999;
            font-size: 0.9em;
        }

        #fileInput {
            display: none;
        }

        .preview-container {
            margin-top: 30px;
            display: none;
        }

        .preview-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .preview-item {
            aspect-ratio: 1;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .preview-item-number {
            position: absolute;
            top: 5px;
            left: 5px;
            background: rgba(102, 126, 234, 0.9);
            color: white;
            padding: 2px 8px;
            border-radius: 5px;
            font-size: 0.8em;
            font-weight: 600;
        }

        .download-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .download-btn:active {
            transform: translateY(0);
        }

        .info {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 10px;
            font-size: 0.9em;
            color: #666;
        }

        .info-title {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 5px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            display: none;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .footer {
            margin-top: 20px;
            text-align: center;
            font-size: 0.85em;
            color: rgba(255, 255, 255, 0.8);
        }

        .footer a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            margin: 0 10px;
            transition: color 0.3s;
        }

        .footer a:hover {
            color: white;
            text-decoration: underline;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideIn 0.3s;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 28px;
            font-weight: bold;
            color: #aaa;
            cursor: pointer;
            transition: color 0.3s;
        }

        .modal-close:hover {
            color: #000;
        }

        .modal h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .modal h3 {
            color: #333;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .modal p,
        .modal li {
            color: #666;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .modal ul {
            margin-left: 20px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ¨ ç”»åƒ9åˆ†å‰²</h1>
        <p class="subtitle">ç”»åƒã‚’3Ã—3ã‚°ãƒªãƒƒãƒ‰ã§9åˆ†å‰²ã—ã¾ã™</p>

        <div class="drop-zone" id="dropZone">
            <div class="drop-zone-icon">ğŸ“¸</div>
            <div class="drop-zone-text">ç”»åƒã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—</div>
            <div class="drop-zone-subtext">ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ</div>
        </div>

        <input type="file" id="fileInput" accept="image/*">

        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <div>å‡¦ç†ä¸­...</div>
        </div>

        <div class="preview-container" id="previewContainer">
            <div class="preview-grid" id="previewGrid"></div>
            <button class="download-btn" id="downloadBtn">
                ğŸ’¾ 9æšã®ç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ (ZIP)
            </button>
        </div>

        <div class="info">
            <div class="info-title">ğŸ“‹ ä»•æ§˜</div>
            <ul style="margin-left: 20px; margin-top: 5px;">
                <li>å½¢å¼: PNG (æœ€é«˜å“è³ª)</li>
                <li>åˆ†å‰²: 3Ã—3 ã‚°ãƒªãƒƒãƒ‰</li>
                <li>å‡¦ç†: å®Œå…¨ã«ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å®Ÿè¡Œ</li>
            </ul>
        </div>
    </div>

    <div class="footer">
        <a href="#" id="termsLink">åˆ©ç”¨è¦ç´„</a> |
        <a href="#" id="privacyLink">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
        <div style="margin-top: 10px;">Â© 2025 ç”»åƒ9åˆ†å‰²ã‚¢ãƒ—ãƒª</div>
    </div>

    <!-- åˆ©ç”¨è¦ç´„ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="termsModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="termsClose">&times;</span>
            <h2>ğŸ“œ åˆ©ç”¨è¦ç´„</h2>

            <h3>ç¬¬1æ¡ï¼ˆé©ç”¨ï¼‰</h3>
            <p>æœ¬åˆ©ç”¨è¦ç´„ã¯ã€æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã€Œç”»åƒ9åˆ†å‰²ã‚¢ãƒ—ãƒªã€ï¼ˆä»¥ä¸‹ã€Œæœ¬ã‚µãƒ¼ãƒ“ã‚¹ã€ï¼‰ã®åˆ©ç”¨æ¡ä»¶ã‚’å®šã‚ã‚‹ã‚‚ã®ã§ã™ã€‚æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã”åˆ©ç”¨ã„ãŸã ãéš›ã«ã¯ã€æœ¬è¦ç´„ã«åŒæ„ã„ãŸã ã„ãŸã‚‚ã®ã¨ã¿ãªã—ã¾ã™ã€‚</p>

            <h3>ç¬¬2æ¡ï¼ˆã‚µãƒ¼ãƒ“ã‚¹å†…å®¹ï¼‰</h3>
            <p>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸç”»åƒã‚’3Ã—3ã‚°ãƒªãƒƒãƒ‰ã§9åˆ†å‰²ã—ã€PNGå½¢å¼ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ç„¡æ–™ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚</p>

            <h3>ç¬¬3æ¡ï¼ˆãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·ï¼‰</h3>
            <ul>
                <li>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯å®Œå…¨ã«ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å‹•ä½œã—ã¾ã™</li>
                <li>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸç”»åƒã¯ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã¾ã›ã‚“</li>
                <li>ã™ã¹ã¦ã®å‡¦ç†ã¯ãŠä½¿ã„ã®ãƒ‡ãƒã‚¤ã‚¹ä¸Šã§å®Œçµã—ã¾ã™</li>
                <li>ç”»åƒãƒ‡ãƒ¼ã‚¿ã¯ä¸€åˆ‡ä¿å­˜ãƒ»åé›†ã•ã‚Œã¾ã›ã‚“</li>
            </ul>

            <h3>ç¬¬4æ¡ï¼ˆè‘—ä½œæ¨©ï¼‰</h3>
            <ul>
                <li>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸç”»åƒã®è‘—ä½œæ¨©ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¸°å±ã—ã¾ã™</li>
                <li>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯ç”»åƒã®è‘—ä½œæ¨©ã‚’ä¸»å¼µã—ã¾ã›ã‚“</li>
                <li>åˆ†å‰²å¾Œã®ç”»åƒã«ã¤ã„ã¦ã‚‚ã€å…ƒã®ç”»åƒã®è‘—ä½œæ¨©è€…ã«æ¨©åˆ©ãŒå¸°å±ã—ã¾ã™</li>
            </ul>

            <h3>ç¬¬5æ¡ï¼ˆç¦æ­¢äº‹é …ï¼‰</h3>
            <p>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ©ç”¨ã«ã‚ãŸã‚Šã€ä»¥ä¸‹ã®è¡Œç‚ºã‚’ç¦æ­¢ã—ã¾ã™ï¼š</p>
            <ul>
                <li>æ³•ä»¤ã¾ãŸã¯å…¬åºè‰¯ä¿—ã«é•åã™ã‚‹è¡Œç‚º</li>
                <li>ä»–è€…ã®è‘—ä½œæ¨©ã€å•†æ¨™æ¨©ç­‰ã®çŸ¥çš„è²¡ç”£æ¨©ã‚’ä¾µå®³ã™ã‚‹è¡Œç‚º</li>
                <li>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã®é‹å–¶ã‚’å¦¨å®³ã™ã‚‹è¡Œç‚º</li>
                <li>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä¸æ­£ãªç›®çš„ã§ä½¿ç”¨ã™ã‚‹è¡Œç‚º</li>
            </ul>

            <h3>ç¬¬6æ¡ï¼ˆå…è²¬äº‹é …ï¼‰</h3>
            <ul>
                <li>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€Œç¾çŠ¶æœ‰å§¿ã€ã§æä¾›ã•ã‚Œã¾ã™</li>
                <li>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ©ç”¨ã«ã‚ˆã‚Šç”Ÿã˜ãŸæå®³ã«ã¤ã„ã¦ã€ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“</li>
                <li>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã®ä¸­æ–­ã€çµ‚äº†ã€å¤‰æ›´ã«ã¤ã„ã¦äº‹å‰ã®é€šçŸ¥ãªãè¡Œã†å ´åˆãŒã‚ã‚Šã¾ã™</li>
                <li>åˆ†å‰²ã•ã‚ŒãŸç”»åƒã®å“è³ªã«ã¤ã„ã¦ä¿è¨¼ã—ã¾ã›ã‚“</li>
            </ul>

            <h3>ç¬¬7æ¡ï¼ˆè¦ç´„ã®å¤‰æ›´ï¼‰</h3>
            <p>æœ¬è¦ç´„ã¯ã€äºˆå‘Šãªãå¤‰æ›´ã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚å¤‰æ›´å¾Œã®è¦ç´„ã¯ã€æœ¬ã‚µãƒ¼ãƒ“ã‚¹ä¸Šã«æ²è¼‰ã•ã‚ŒãŸæ™‚ç‚¹ã§åŠ¹åŠ›ã‚’ç”Ÿã˜ã¾ã™ã€‚</p>

            <p style="margin-top: 20px; text-align: right; color: #999;">æœ€çµ‚æ›´æ–°æ—¥: 2025å¹´12æœˆ20æ—¥</p>
        </div>
    </div>

    <!-- ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="privacyModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="privacyClose">&times;</span>
            <h2>ğŸ”’ ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</h2>

            <h3>1. å€‹äººæƒ…å ±ã®åé›†ã«ã¤ã„ã¦</h3>
            <p>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€ä¸€åˆ‡ã®å€‹äººæƒ…å ±ã‚’åé›†ã—ã¾ã›ã‚“ã€‚</p>

            <h3>2. ç”»åƒãƒ‡ãƒ¼ã‚¿ã®å–ã‚Šæ‰±ã„</h3>
            <ul>
                <li><strong>ã‚µãƒ¼ãƒãƒ¼ã¸ã®é€ä¿¡ãªã—</strong>: ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸç”»åƒã¯ã€ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§ã®ã¿å‡¦ç†ã•ã‚Œã¾ã™</li>
                <li><strong>ä¿å­˜ãªã—</strong>: ç”»åƒãƒ‡ãƒ¼ã‚¿ã¯ä¸€åˆ‡ä¿å­˜ã•ã‚Œã¾ã›ã‚“</li>
                <li><strong>ç¬¬ä¸‰è€…ã¸ã®æä¾›ãªã—</strong>: ç”»åƒãƒ‡ãƒ¼ã‚¿ãŒç¬¬ä¸‰è€…ã«æä¾›ã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“</li>
                <li><strong>å®Œå…¨ãªãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†</strong>: ã™ã¹ã¦ã®å‡¦ç†ã¯ãŠä½¿ã„ã®ãƒ‡ãƒã‚¤ã‚¹ä¸Šã§å®Œçµã—ã¾ã™</li>
            </ul>

            <h3>3. Cookieãƒ»ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</h3>
            <p>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€Cookieã€ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã€ãã®ä»–ã®ãƒ–ãƒ©ã‚¦ã‚¶ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æŠ€è¡“ã‚’ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚</p>

            <h3>4. ã‚¢ã‚¯ã‚»ã‚¹è§£æãƒ„ãƒ¼ãƒ«</h3>
            <p>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯ã€ç¾æ™‚ç‚¹ã§ã‚¢ã‚¯ã‚»ã‚¹è§£æãƒ„ãƒ¼ãƒ«ï¼ˆGoogle Analyticsç­‰ï¼‰ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã›ã‚“ã€‚</p>

            <h3>5. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</h3>
            <ul>
                <li>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯HTTPSé€šä¿¡ã§æä¾›ã•ã‚Œã¾ã™ï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤å¾Œï¼‰</li>
                <li>ç”»åƒå‡¦ç†ã¯å®Œå…¨ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§è¡Œã‚ã‚Œã‚‹ãŸã‚ã€é€šä¿¡ã«ã‚ˆã‚‹æƒ…å ±æ¼æ´©ã®ãƒªã‚¹ã‚¯ã¯ã‚ã‚Šã¾ã›ã‚“</li>
            </ul>

            <h3>6. æŠ€è¡“çš„ãªä»•çµ„ã¿</h3>
            <p>æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯ä»¥ä¸‹ã®æŠ€è¡“ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ï¼š</p>
            <ul>
                <li><strong>HTML5 Canvas API</strong>: ç”»åƒã®åˆ†å‰²å‡¦ç†</li>
                <li><strong>File API</strong>: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿</li>
                <li><strong>JSZip</strong>: ZIPå½¢å¼ã§ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</li>
            </ul>
            <p>ã“ã‚Œã‚‰ã¯ã™ã¹ã¦ãƒ–ãƒ©ã‚¦ã‚¶å†…ã§å‹•ä½œã—ã€å¤–éƒ¨ã‚µãƒ¼ãƒãƒ¼ã¨ã®é€šä¿¡ã¯ç™ºç”Ÿã—ã¾ã›ã‚“ã€‚</p>

            <h3>7. ãŠå•ã„åˆã‚ã›</h3>
            <p>æœ¬ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã«é–¢ã™ã‚‹ãŠå•ã„åˆã‚ã›ã¯ã€GitHubã®Issueã«ã¦ãŠé¡˜ã„ã—ã¾ã™ã€‚</p>

            <p style="margin-top: 20px; text-align: right; color: #999;">æœ€çµ‚æ›´æ–°æ—¥: 2025å¹´12æœˆ20æ—¥</p>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script>
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const previewContainer = document.getElementById('previewContainer');
        const previewGrid = document.getElementById('previewGrid');
        const downloadBtn = document.getElementById('downloadBtn');
        const loading = document.getElementById('loading');

        let splitImages = [];

        // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã‚¤ãƒ™ãƒ³ãƒˆ
        dropZone.addEventListener('click', () => fileInput.click());

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('image/')) {
                processImage(file);
            }
        });

        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                processImage(file);
            }
        });

        async function processImage(file) {
            loading.style.display = 'block';
            previewContainer.style.display = 'none';
            previewGrid.innerHTML = '';
            splitImages = [];

            const img = new Image();
            const reader = new FileReader();

            reader.onload = (e) => {
                img.src = e.target.result;
            };

            img.onload = () => {
                splitImageIntoNine(img);
                loading.style.display = 'none';
                previewContainer.style.display = 'block';
            };

            reader.readAsDataURL(file);
        }

        function splitImageIntoNine(img) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');

            const panelWidth = Math.floor(img.width / 3);
            const panelHeight = Math.floor(img.height / 3);

            canvas.width = panelWidth;
            canvas.height = panelHeight;

            let panelNum = 1;

            for (let row = 0; row < 3; row++) {
                for (let col = 0; col < 3; col++) {
                    // ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ã‚¯ãƒªã‚¢
                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    // ç”»åƒã®ä¸€éƒ¨ã‚’åˆ‡ã‚Šå–ã‚Š
                    const sx = col * panelWidth;
                    const sy = row * panelHeight;

                    ctx.drawImage(
                        img,
                        sx, sy, panelWidth, panelHeight,
                        0, 0, panelWidth, panelHeight
                    );

                    // PNGã¨ã—ã¦ä¿å­˜
                    const dataUrl = canvas.toDataURL('image/png');
                    splitImages.push({
                        number: panelNum,
                        dataUrl: dataUrl
                    });

                    // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ä½œæˆ
                    const previewItem = document.createElement('div');
                    previewItem.className = 'preview-item';
                    previewItem.innerHTML = `
                        <img src="${dataUrl}" alt="Panel ${panelNum}">
                        <div class="preview-item-number">${panelNum}</div>
                    `;
                    previewGrid.appendChild(previewItem);

                    panelNum++;
                }
            }
        }

        downloadBtn.addEventListener('click', async () => {
            const zip = new JSZip();

            splitImages.forEach((img) => {
                const base64Data = img.dataUrl.split(',')[1];
                zip.file(`panel_${String(img.number).padStart(2, '0')}.png`, base64Data, { base64: true });
            });

            const blob = await zip.generateAsync({ type: 'blob' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'split_images.zip';
            a.click();
            URL.revokeObjectURL(url);
        });

        // ãƒ¢ãƒ¼ãƒ€ãƒ«æ©Ÿèƒ½
        const termsModal = document.getElementById('termsModal');
        const privacyModal = document.getElementById('privacyModal');
        const termsLink = document.getElementById('termsLink');
        const privacyLink = document.getElementById('privacyLink');
        const termsClose = document.getElementById('termsClose');
        const privacyClose = document.getElementById('privacyClose');

        termsLink.addEventListener('click', (e) => {
            e.preventDefault();
            termsModal.style.display = 'block';
        });

        privacyLink.addEventListener('click', (e) => {
            e.preventDefault();
            privacyModal.style.display = 'block';
        });

        termsClose.addEventListener('click', () => {
            termsModal.style.display = 'none';
        });

        privacyClose.addEventListener('click', () => {
            privacyModal.style.display = 'none';
        });

        window.addEventListener('click', (e) => {
            if (e.target === termsModal) {
                termsModal.style.display = 'none';
            }
            if (e.target === privacyModal) {
                privacyModal.style.display = 'none';
            }
        });
    </script>
</body>

</html>